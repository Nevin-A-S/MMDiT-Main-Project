/media/sct/projects/MMDit/Project/MMDiT-Main-Project/SampleMMditControlnet.py:237: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.no_grad(), torch.cuda.amp.autocast(enabled=args.mixed_precision == "fp16"):
  0%|                             | 0/1000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/SampleMMditControlnet.py", line 305, in <module>
    main(args)
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/SampleMMditControlnet.py", line 249, in main
    samples = diffusion.p_sample_loop(
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/gaussian_diffusion.py", line 426, in p_sample_loop
    for sample in self.p_sample_loop_progressive(
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/gaussian_diffusion.py", line 477, in p_sample_loop_progressive
    out = self.p_sample(
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/gaussian_diffusion.py", line 380, in p_sample
    out = self.p_mean_variance(
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/respace.py", line 82, in p_mean_variance
    return super().p_mean_variance(self._wrap_model(model), *args, **kwargs)
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/gaussian_diffusion.py", line 259, in p_mean_variance
    model_output = model(x, t, **model_kwargs)
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/diffusion/respace.py", line 115, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/models/mmdit_control_net.py", line 114, in forward_with_cfg
    model_out = self.forward(combined, t, c, edges)
  File "/media/sct/projects/MMDit/Project/MMDiT-Main-Project/opendit/models/mmdit_control_net.py", line 84, in forward
    t = t + ts_proj
RuntimeError: The size of tensor a (128) must match the size of tensor b (64) at non-singleton dimension 0
(py310) sct@hpcnode4:/media/sct/projects/MMDit/Project/MMDiT-Main-Project$ ^C
(py310) sct@hpcnode4:/media/sct/projects/MMDit/Project/MMDiT-Main-Project$ 